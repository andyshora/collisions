(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// import { Game } from './Game.js';

'use strict';

paper.install(window);

var SHAPE_RADIUS = 4;
var NUM_SHAPES = 60;
var NUM_RINGS = 4;
var RING_RADIUS = 0.08;
var PART_SIZE = 0.1;
var SHAPE_SIZE = 0.2;

var WIDTH = undefined;
var HEIGHT = undefined;
var shapesArr = [];
var ineligibleShapes = [];
var explodingShapes = [];
var symbols = [];
var trace = undefined;
var move = undefined;
var latestExplosionGroup = undefined,
    ringGroups = undefined,
    backgroundGroup = undefined;
var latestExplosionWeight = undefined;
var currentBulletIndex = undefined,
    currentTargetIndex = undefined,
    bulletSpeed = undefined,
    orbitSpeed = undefined;

var COLORS = ['rgba(0, 196, 194, 1)', 'rgba(0, 157, 249, 1)', 'rgba(255, 0, 217, 1)', 'rgba(247, 255, 0, 1)'];

var createTracePath = function createTracePath() {
  var path = new Path.Circle(new Point(0, 0), 1);
  path.fillColor = 'rgb(255, 255, 255)';
  path.opacity = 0.2;
  return path;
};

var getScaledColor = function getScaledColor(str, scale) {
  return str.replace(', 1)', ', ' + scale + ')');
};

var createExplosionPath = function createExplosionPath(radius, colorIndex) {
  var path = new Path.Circle(new Point(0, 0), radius);
  path.opacity = 0.3;

  path.fillColor = {
    gradient: {
      stops: [[getScaledColor(COLORS[colorIndex], 0.8), 0], [getScaledColor(COLORS[colorIndex], 0.2), 0.2], [getScaledColor(COLORS[colorIndex], 0), 1]],
      radial: true
    },
    origin: path.position,
    destination: path.bounds.rightCenter
  };

  return path;
};

var createCirclePath = function createCirclePath() {
  var path = new Path.Circle(new Point(0, 0), SHAPE_RADIUS);
  path.fillColor = COLORS[0];
  return path;
};

var createCirclePath2 = function createCirclePath2() {
  var path = new Path.Circle(new Point(0, 0), SHAPE_RADIUS);
  path.fillColor = COLORS[1];
  return path;
};

var createSquarePath = function createSquarePath() {
  var path = new Path.Rectangle(new Point(0, 0), new Point(SHAPE_RADIUS * 2, SHAPE_RADIUS * 2));

  path.fillColor = COLORS[1];
  return path;
};

var createTrianglePath = function createTrianglePath() {
  var path = new Path.RegularPolygon(new Point(0, 0), 3, SHAPE_RADIUS * 2);
  path.fillColor = COLORS[2];

  return path;
};

var createHexagonPath = function createHexagonPath() {
  // Create a Paper.js Path to draw a line into it:
  var hexagon = new Path();

  var points = 6;
  var radius = SHAPE_RADIUS * 1.6;
  var angle = 2 * Math.PI / points;

  for (var i = 0; i <= points; i++) {
    hexagon.add(new Point(radius * Math.cos(angle * i), radius * Math.sin(angle * i)));
  }

  hexagon.fillColor = COLORS[3];

  return hexagon;
};

var changeBulletSpeed = function changeBulletSpeed(speed) {
  bulletSpeed = speed;
};

var changeOrbitSpeed = function changeOrbitSpeed(speed) {
  orbitSpeed = speed;
};

var createRandomShape = function createRandomShape(pos) {
  var shapeIndex = chance.integer({ min: 0, max: 3 });
  var path = undefined;

  switch (shapeIndex) {
    case 0:
      path = circle.place(new Point(pos.x, pos.y));
      break;
    case 1:
      path = square.place(new Point(pos.x, pos.y));
      break;
    case 2:
      path = hexagon.place(new Point(pos.x, pos.y));
      break;
    case 3:
      path = triangle.place(new Point(pos.x, pos.y));
      break;
  }
  return path;
};

var tool = undefined;

window.onload = function () {
  var chance = new Chance();
  var canvas = document.getElementById('canvas');
  tool = new Tool();

  WIDTH = window.innerWidth;
  HEIGHT = window.innerHeight;

  console.log(WIDTH, HEIGHT);

  paper.setup(canvas);
  paper.view.onResize = onResize;
  paper.view.onFrame = onFrame;

  tool.onMouseDown = onMouseDown;
  tool.onMouseDrag = onMouseDrag;

  setupShapes();
  fireNewShape();

  document.getElementById('bulletSpeed').addEventListener('change', function (e) {
    changeBulletSpeed(e.target.valueAsNumber);
  });

  document.getElementById('orbitSpeed').addEventListener('change', function (e) {
    changeOrbitSpeed(e.target.valueAsNumber);
  });

  setTimeout(function () {
    document.body.className += 'app--loaded';
  }, 2000);
};

var setupShapes = function setupShapes() {

  bulletSpeed = 3;
  orbitSpeed = 2;

  var degreesPerSeg = 360 / NUM_SHAPES;
  var centerPos = paper.view.center;

  backgroundGroup = new Group();

  trace = new Symbol(createTracePath());
  ringGroups = [];

  for (var i = 0; i < NUM_RINGS; i++) {
    ringGroups.push(new Group());

    // create shape symbol
    var symbolPath = new Path.Circle(new Point(0, 0), SHAPE_RADIUS);
    symbolPath.fillColor = COLORS[i];

    symbols.push(new Symbol(symbolPath));

    for (var j = 0; j < NUM_SHAPES; j++) {

      var theta = j * degreesPerSeg;

      var pos = {
        x: centerPos.x + Math.cos(d2r(theta)) * HEIGHT * RING_RADIUS * (i + 2),
        y: centerPos.y + Math.sin(d2r(theta)) * HEIGHT * RING_RADIUS * (i + 2)
      };

      var placed = symbols[i].place(new Point(pos.x, pos.y));
      var size = chance.floating({ min: SHAPE_SIZE, max: SHAPE_SIZE * (i + 1) });
      placed.scale(size);

      placed.data.eligible = true;
      placed.data.colorIndex = i;
      placed.data.size = size;

      shapesArr.push(placed);
      ringGroups[i].addChild(placed);
    }
  }
};

var repositionShapes = function repositionShapes() {

  var degreesPerSeg = 360 / NUM_SHAPES;
  var centerPos = paper.view.center;

  for (var i = 0; i < NUM_RINGS; i++) {

    for (var j = 0; j < NUM_SHAPES; j++) {

      var theta = j * degreesPerSeg;

      var pos = {
        x: centerPos.x + Math.cos(d2r(theta)) * HEIGHT * RING_RADIUS * (i + 2),
        y: centerPos.y + Math.sin(d2r(theta)) * HEIGHT * RING_RADIUS * (i + 2)
      };

      var indx = i * NUM_SHAPES + j;

      if (indx < shapesArr.length) {
        shapesArr[indx].position = pos;
      }
    }
  }
};

var onResize = function onResize(view) {
  WIDTH = view.size.width;
  HEIGHT = view.size.height;

  repositionShapes();
};

var d2r = function d2r(deg) {
  return deg * Math.PI / 180;
};

var playSound = function playSound(sound) {
  // todo - find sounds and implement this
};

var onCollide = function onCollide(bullet, target, angle) {
  // console.log('onCollide', bullet);
  // shape has been collided with
  // create a few more shapes at its position
  // then remove it
  bullet.remove();

  playSound('hit');

  for (var i = 0; i < traces.length; i++) {
    traces[i].remove();
  }

  // remove target
  target.data.eligible = false;
  target.opacity = 0;

  var explosionRadius = chance.integer({ min: 10, max: 30 });
  var numParts = 12;
  var explosionShape = createExplosionPath(explosionRadius, target.data.colorIndex);
  explosionShape.position = target.position;

  var ellipsisMultiplier = chance.floating({ min: 0.2, max: 1.8 });
  explosionShape.scale({ x: 1, y: ellipsisMultiplier });
  latestExplosionGroup = new Group([explosionShape]);
  latestExplosionWeight = explosionRadius / 50;

  for (var i = 0; i < numParts; i++) {

    // const theta = angle + (i * (180 / numParts)) - 90;
    var theta = angle + i * (360 / numParts);

    var pos = {
      x: target.position.x + explosionRadius * Math.cos(d2r(theta)),
      y: target.position.y + explosionRadius * Math.sin(d2r(theta)) * ellipsisMultiplier
    };

    var placed = symbols[target.data.colorIndex].place(new Point(pos.x, pos.y));
    // placed.rotate(chance.integer({ min: 0, max: 180 }));
    var size = chance.floating({ min: PART_SIZE, max: PART_SIZE * (target.data.colorIndex + 1) });
    placed.scale(size);

    placed.data.eligible = false;
    placed.data.size = size;
    placed.data.colorIndex = target.data.colorIndex;
    placed.data.origin = target.position;
    placed.data.theta = theta;
    placed.data.parentPosition = target.position;

    explodingShapes.push(placed);
    ineligibleShapes.push(placed);

    shapesArr.push(placed);
    latestExplosionGroup.addChild(placed);
  }

  backgroundGroup.addChild(latestExplosionGroup);

  NUM_SHAPES += numParts - 1;
  explosionInProgress = true;

  fireNewShape();
};

var fireNewShape = function fireNewShape() {

  playSound('fire');

  currentBulletIndex = chance.integer({ min: 0, max: shapesArr.length - 1 });

  // ensure no newly created particles are the new target
  currentTargetIndex = chance.integer({ min: 0, max: shapesArr.length - 1 });

  if (shapesArr[currentBulletIndex].data.eligible && currentBulletIndex !== currentTargetIndex && typeof shapesArr[currentBulletIndex]._index !== 'undefined') {
    move = true;
  } else {
    // console.warn('not eligible');
    fireNewShape();
  }
};

var lastShiftedAt = 0;
var shiftEvery = 200;
var explosionInProgress = false;
var traces = [];

var onMouseDown = function onMouseDown(event) {

  if (!backgroundGroup) {
    backgroundGroup = new Group();
  }

  var indx = chance.integer({ min: 0, max: symbols.length - 1 });

  var pos = event.point;
  var placed = symbols[indx].place(new Point(pos.x, pos.y));
  placed.data.colorIndex = indx;
  // placed.rotate(chance.integer({ min: 0, max: 180 }));
  var size = chance.floating({ min: SHAPE_SIZE, max: SHAPE_SIZE * (indx + 1) });
  placed.scale(size);

  placed.data.eligible = true;
  placed.data.size = size;
  shapesArr.push(placed);
  backgroundGroup.addChild(placed);
  NUM_SHAPES++;
};

var numDragEvents = 0;

var onMouseDrag = function onMouseDrag(event) {

  if (numDragEvents % 2 === 0) {
    onMouseDown(event);
  }

  numDragEvents++;
};

var onFrame = function onFrame(event) {
  // console.log(event);

  // ringGroup.rotate(.1);
  // innerRingGroup.rotate(-0.1);
  for (var i = 0; i < NUM_RINGS; i++) {
    var speed = (NUM_RINGS - i) * 0.01 * orbitSpeed;
    ringGroups[i].rotate(speed, paper.view.center);
  }

  if (latestExplosionGroup && latestExplosionGroup.children.length) {
    latestExplosionGroup.rotate(latestExplosionWeight);
  }

  if (backgroundGroup && backgroundGroup.children.length) {
    backgroundGroup.rotate(0.01 * orbitSpeed, paper.view.center);
  }

  // moving bullet
  if (move) {
    var vector = shapesArr[currentTargetIndex].position.subtract(shapesArr[currentBulletIndex].position);
    var originalLength = vector.length;

    // if (event.count % 2 === 0) {
    traces.push(trace.place(new Point(shapesArr[currentBulletIndex].position)));

    // }

    vector.length = WIDTH / 2;
    shapesArr[currentBulletIndex].position = shapesArr[currentBulletIndex].position.add(vector.divide(360 / bulletSpeed));
    shapesArr[currentBulletIndex].rotate(1);

    if (originalLength < 5) {

      move = false;
      onCollide(shapesArr[currentBulletIndex], shapesArr[currentTargetIndex], vector.angle);
    }
  }

  if (explosionInProgress) {
    // move parts out from their origin
    for (var i = 0; i < explodingShapes.length; i++) {
      var vector = explodingShapes[i].data.parentPosition.subtract(explodingShapes[i].position);
      if (vector.length > 50) {
        explodingShapes = [];
      } else {
        explodingShapes[i].position = explodingShapes[i].position.subtract(vector.divide(300));
        // explodingShapes[i].rotate(10);
      }
    }
  }

  // enable new shapes as bullets and targets
  if (event.count - lastShiftedAt > shiftEvery && ineligibleShapes.length) {
    shiftEvery = ineligibleShapes.length > 200 ? 1 : 200;
    ineligibleShapes[0].data.eligible = true;
    ineligibleShapes.shift();
    lastShiftedAt = event.count;
  }

  // triangle.definition.rotate(0.5);
  // square.definition.rotate(0.4);
  // hexagon.definition.rotate(0.2);
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvYW5keXNob3JhL0Rldi9jb2xsaXNpb25zL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDRUEsWUFBWSxDQUFDOztBQUViLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7O0FBRXRCLElBQU0sWUFBWSxHQUFHLENBQUMsQ0FBQztBQUN2QixJQUFJLFVBQVUsR0FBRyxFQUFFLENBQUM7QUFDcEIsSUFBSSxTQUFTLEdBQUcsQ0FBQyxDQUFDO0FBQ2xCLElBQUksV0FBVyxHQUFHLElBQUksQ0FBQztBQUN2QixJQUFJLFNBQVMsR0FBRyxHQUFHLENBQUM7QUFDcEIsSUFBSSxVQUFVLEdBQUcsR0FBRyxDQUFDOztBQUVyQixJQUFJLEtBQUssWUFBQSxDQUFDO0FBQ1YsSUFBSSxNQUFNLFlBQUEsQ0FBQztBQUNYLElBQUksU0FBUyxHQUFHLEVBQUUsQ0FBQztBQUNuQixJQUFJLGdCQUFnQixHQUFHLEVBQUUsQ0FBQztBQUMxQixJQUFJLGVBQWUsR0FBRyxFQUFFLENBQUM7QUFDekIsSUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDO0FBQ2pCLElBQUksS0FBSyxZQUFBLENBQUM7QUFDVixJQUFJLElBQUksWUFBQSxDQUFDO0FBQ1QsSUFBSSxvQkFBb0IsWUFBQTtJQUFFLFVBQVUsWUFBQTtJQUFFLGVBQWUsWUFBQSxDQUFDO0FBQ3RELElBQUkscUJBQXFCLFlBQUEsQ0FBQztBQUMxQixJQUFJLGtCQUFrQixZQUFBO0lBQUUsa0JBQWtCLFlBQUE7SUFBRSxXQUFXLFlBQUE7SUFBRSxVQUFVLFlBQUEsQ0FBQzs7QUFFcEUsSUFBTSxNQUFNLEdBQUcsQ0FDYixzQkFBc0IsRUFDdEIsc0JBQXNCLEVBQ3RCLHNCQUFzQixFQUN0QixzQkFBc0IsQ0FDdkIsQ0FBQzs7QUFFRixJQUFNLGVBQWUsR0FBRyxTQUFsQixlQUFlLEdBQVM7QUFDNUIs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QUV4RjtLQUNGO0dBQ0Y7OztBQUdELE1BQUksQUFBQyxLQUFLLENBQUMsS0FBSyxHQUFHLGFBQWEsR0FBRyxVQUFVLElBQUssZ0JBQWdCLENBQUMsTUFBTSxFQUFFO0FBQ3pFLGNBQVUsR0FBRyxnQkFBZ0IsQ0FBQyxNQUFNLEdBQUcsR0FBRyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUM7QUFDckQsb0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7QUFDekMsb0JBQWdCLENBQUMsS0FBSyxFQUFFLENBQUM7QUFDekIsaUJBQWEsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDO0dBQzdCOzs7OztDQU1GLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8gaW1wb3J0IHsgR2FtZSB9IGZyb20gJy4vR2FtZS5qcyc7XG5cbid1c2Ugc3RyaWN0JztcblxucGFwZXIuaW5zdGFsbCh3aW5kb3cpO1xuXG5jb25zdCBTSEFQRV9SQURJVVMgPSA0O1xubGV0IE5VTV9TSEFQRVMgPSA2MDtcbmxldCBOVU1fUklOR1MgPSA0O1xubGV0IFJJTkdfUkFESVVTID0gMC4wODtcbmxldCBQQVJUX1NJWkUgPSAwLjE7XG5sZXQgU0hBUEVfU0laRSA9IDAuMjtcblxubGV0IFdJRFRIO1xubGV0IEhFSUdIVDtcbmxldCBzaGFwZXNBcnIgPSBbXTtcbmxldCBpbmVsaWdpYmxlU2hhcGVzID0gW107XG5sZXQgZXhwbG9kaW5nU2hhcGVzID0gW107XG5sZXQgc3ltYm9scyA9IFtdO1xubGV0IHRyYWNlO1xubGV0IG1vdmU7XG5sZXQgbGF0ZXN0RXhwbG9zaW9uR3JvdXAsIHJpbmdHcm91cHMsIGJhY2tncm91bmRHcm91cDtcbmxldCBsYXRlc3RFeHBsb3Npb25XZWlnaHQ7XG5sZXQgY3VycmVudEJ1bGxldEluZGV4LCBjdXJyZW50VGFyZ2V0SW5kZXgsIGJ1bGxldFNwZWVkLCBvcmJpdFNwZWVkO1xuXG5jb25zdCBDT0xPUlMgPSBbXG4gICdyZ2JhKDAsIDE5NiwgMTk0LCAxKScsXG4gICdyZ2JhKDAsIDE1NywgMjQ5LCAxKScsXG4gICdyZ2JhKDI1NSwgMCwgMjE3LCAxKScsXG4gICdyZ2JhKDI0NywgMjU1LCAwLCAxKSdcbl07XG5cbmNvbnN0IGNyZWF0ZVRyYWNlUGF0aCA9ICgpID0+IHtcbiAgbGV0IHBhdGggPSBuZXcgUGF0aC5DaXJjbGUobmV3IFBvaW50KDAsIDApLCAxKTtcbiAgcGF0aC5maWxsQ29sb3IgPSAncmdiKDI1NSwgMjU1LCAyNTUpJztcbiAgcGF0aC5vcGFjaXR5ID0gMC4yO1xuICByZXR1cm4gcGF0aDtcbn07XG5cbmNvbnN0IGdldFNjYWxlZENvbG9yID0gKHN0ciwgc2NhbGUpID0+IHtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKCcsIDEpJywgYCwgJHsgc2NhbGUgfSlgKTtcbn07XG5cbmNvbnN0IGNyZWF0ZUV4cGxvc2lvblBhdGggPSAocmFkaXVzLCBjb2xvckluZGV4KSA9PiB7XG4gIGxldCBwYXRoID0gbmV3IFBhdGguQ2lyY2xlKG5ldyBQb2ludCgwLCAwKSwgcmFkaXVzKTtcbiAgcGF0aC5vcGFjaXR5ID0gMC4zO1xuXG4gIHBhdGguZmlsbENvbG9yID0ge1xuICAgIGdyYWRpZW50OiB7XG4gICAgICBzdG9wczogW1tnZXRTY2FsZWRDb2xvcihDT0xPUlNbY29sb3JJbmRleF0sIDAuOCksIDBdLCBbZ2V0U2NhbGVkQ29sb3IoQ09MT1JTW2NvbG9ySW5kZXhdLCAwLjIpLCAwLjJdLCBbZ2V0U2NhbGVkQ29sb3IoQ09MT1JTW2NvbG9ySW5kZXhdLCAwKSwgMV1dLFxuICAgICAgcmFkaWFsOiB0cnVlXG4gICAgfSxcbiAgICBvcmlnaW46IHBhdGgucG9zaXRpb24sXG4gICAgZGVzdGluYXRpb246IHBhdGguYm91bmRzLnJpZ2h0Q2VudGVyXG4gIH07XG5cbiAgcmV0dXJuIHBhdGg7XG59O1xuXG5jb25zdCBjcmVhdGVDaXJjbGVQYXRoID0gKCkgPT4ge1xuICBsZXQgcGF0aCA9IG5ldyBQYXRoLkNpcmNsZShuZXcgUG9pbnQoMCwgMCksIFNIQVBFX1JBRElVUyk7XG4gIHBhdGguZmlsbENvbG9yID0gQ09MT1JTWzBdO1xuICByZXR1cm4gcGF0aDtcbn07XG5cbmNvbnN0IGNyZWF0ZUNpcmNsZVBhdGgyID0gKCkgPT4ge1xuICBsZXQgcGF0aCA9IG5ldyBQYXRoLkNpcmNsZShuZXcgUG9pbnQoMCwgMCksIFNIQVBFX1JBRElVUyk7XG4gIHBhdGguZmlsbENvbG9yID0gQ09MT1JTWzFdO1xuICByZXR1cm4gcGF0aDtcbn07XG5cbmNvbnN0IGNyZWF0ZVNxdWFyZVBhdGggPSAoKSA9PiB7XG4gIGxldCBwYXRoID0gbmV3IFBhdGguUmVjdGFuZ2xlKG5ldyBQb2ludCgwLCAwKSwgbmV3IFBvaW50KFNIQVBFX1JBRElVUyAqIDIsIFNIQVBFX1JBRElVUyAqIDIpKTtcblxuICBwYXRoLmZpbGxDb2xvciA9IENPTE9SU1sxXTtcbiAgcmV0dXJuIHBhdGg7XG59O1xuXG5jb25zdCBjcmVhdGVUcmlhbmdsZVBhdGggPSAoKSA9PiB7XG4gIGxldCBwYXRoID0gbmV3IFBhdGguUmVndWxhclBvbHlnb24obmV3IFBvaW50KDAsIDApLCAzLCBTSEFQRV9SQURJVVMgKiAyKTtcbiAgcGF0aC5maWxsQ29sb3IgPSBDT0xPUlNbMl07XG5cbiAgcmV0dXJuIHBhdGg7XG59O1xuXG5jb25zdCBjcmVhdGVIZXhhZ29uUGF0aCA9ICgpID0+IHtcbiAgLy8gQ3JlYXRlIGEgUGFwZXIuanMgUGF0aCB0byBkcmF3IGEgbGluZSBpbnRvIGl0OlxuICB2YXIgaGV4YWdvbiA9IG5ldyBQYXRoKCk7XG5cbiAgdmFyIHBvaW50cyA9IDY7XG4gIHZhciByYWRpdXMgPSBTSEFQRV9SQURJVVMgKiAxLjY7XG4gIHZhciBhbmdsZSA9ICgoMiAqIE1hdGguUEkpIC8gcG9pbnRzKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8PSBwb2ludHM7IGkrKykge1xuICAgIGhleGFnb24uYWRkKG5ldyBQb2ludChcbiAgICAgIHJhZGl1cyAqIE1hdGguY29zKGFuZ2xlICogaSksXG4gICAgICByYWRpdXMgKiBNYXRoLnNpbihhbmdsZSAqIGkpXG4gICAgKSk7XG4gIH1cblxuICBoZXhhZ29uLmZpbGxDb2xvciA9IENPTE9SU1szXTtcblxuICByZXR1cm4gaGV4YWdvbjtcbn07XG5cbmNvbnN0IGNoYW5nZUJ1bGxldFNwZWVkID0gc3BlZWQgPT4ge1xuICBidWxsZXRTcGVlZCA9IHNwZWVkO1xufTtcblxuY29uc3QgY2hhbmdlT3JiaXRTcGVlZCA9IHNwZWVkID0+IHtcbiAgb3JiaXRTcGVlZCA9IHNwZWVkO1xufTtcblxuY29uc3QgY3JlYXRlUmFuZG9tU2hhcGUgPSBwb3MgPT4ge1xuICBjb25zdCBzaGFwZUluZGV4ID0gY2hhbmNlLmludGVnZXIoeyBtaW46IDAsIG1heDogMyB9KTtcbiAgbGV0IHBhdGg7XG5cbiAgc3dpdGNoIChzaGFwZUluZGV4KSB7XG4gIGNhc2UgMDpcbiAgICBwYXRoID0gY2lyY2xlLnBsYWNlKG5ldyBQb2ludChwb3MueCwgcG9zLnkpKTtcbiAgICBicmVhaztcbiAgY2FzZSAxOlxuICAgIHBhdGggPSBzcXVhcmUucGxhY2UobmV3IFBvaW50KHBvcy54LCBwb3MueSkpO1xuICAgIGJyZWFrO1xuICBjYXNlIDI6XG4gICAgcGF0aCA9IGhleGFnb24ucGxhY2UobmV3IFBvaW50KHBvcy54LCBwb3MueSkpO1xuICAgIGJyZWFrO1xuICBjYXNlIDM6XG4gICAgcGF0aCA9IHRyaWFuZ2xlLnBsYWNlKG5ldyBQb2ludChwb3MueCwgcG9zLnkpKTtcbiAgICBicmVhaztcbiAgfVxuICByZXR1cm4gcGF0aDtcbn1cblxubGV0IHRvb2w7XG5cbndpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XG4gIGxldCBjaGFuY2UgPSBuZXcgQ2hhbmNlKCk7XG4gIGxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XG4gIHRvb2wgPSBuZXcgVG9vbCgpO1xuXG4gIFdJRFRIID0gd2luZG93LmlubmVyV2lkdGg7XG4gIEhFSUdIVCA9IHdpbmRvdy5pbm5lckhlaWdodDtcblxuICBjb25zb2xlLmxvZyhXSURUSCwgSEVJR0hUKTtcblxuICBwYXBlci5zZXR1cChjYW52YXMpO1xuICBwYXBlci52aWV3Lm9uUmVzaXplID0gb25SZXNpemU7XG4gIHBhcGVyLnZpZXcub25GcmFtZSA9IG9uRnJhbWU7XG5cbiAgdG9vbC5vbk1vdXNlRG93biA9IG9uTW91c2VEb3duO1xuICB0b29sLm9uTW91c2VEcmFnID0gb25Nb3VzZURyYWc7XG5cbiAgc2V0dXBTaGFwZXMoKTtcbiAgZmlyZU5ld1NoYXBlKCk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J1bGxldFNwZWVkJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZSA9PiB7XG4gICAgY2hhbmdlQnVsbGV0U3BlZWQoZS50YXJnZXQudmFsdWVBc051bWJlcik7XG4gIH0pO1xuXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcmJpdFNwZWVkJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZSA9PiB7XG4gICAgY2hhbmdlT3JiaXRTcGVlZChlLnRhcmdldC52YWx1ZUFzTnVtYmVyKTtcbiAgfSk7XG5cbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc05hbWUgKz0gJ2FwcC0tbG9hZGVkJztcbiAgfSwgMjAwMCk7XG5cbn07XG5cbmNvbnN0IHNldHVwU2hhcGVzID0gKCkgPT4ge1xuXG4gIGJ1bGxldFNwZWVkID0gMztcbiAgb3JiaXRTcGVlZCA9IDI7XG5cbiAgY29uc3QgZGVncmVlc1BlclNlZyA9IDM2MCAvIE5VTV9TSEFQRVM7XG4gIGNvbnN0IGNlbnRlclBvcyA9IHBhcGVyLnZpZXcuY2VudGVyO1xuXG4gIGJhY2tncm91bmRHcm91cCA9IG5ldyBHcm91cCgpO1xuXG4gIHRyYWNlID0gbmV3IFN5bWJvbChjcmVhdGVUcmFjZVBhdGgoKSk7XG4gIHJpbmdHcm91cHMgPSBbXTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IE5VTV9SSU5HUzsgaSsrKSB7XG4gICAgcmluZ0dyb3Vwcy5wdXNoKG5ldyBHcm91cCgpKTtcblxuICAgIC8vIGNyZWF0ZSBzaGFwZSBzeW1ib2xcbiAgICBsZXQgc3ltYm9sUGF0aCA9IG5ldyBQYXRoLkNpcmNsZShuZXcgUG9pbnQoMCwgMCksIFNIQVBFX1JBRElVUyk7XG4gICAgc3ltYm9sUGF0aC5maWxsQ29sb3IgPSBDT0xPUlNbaV07XG5cbiAgICBzeW1ib2xzLnB1c2gobmV3IFN5bWJvbChzeW1ib2xQYXRoKSk7XG5cblxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgTlVNX1NIQVBFUzsgaisrKSB7XG5cbiAgICAgIGxldCB0aGV0YSA9IGogKiBkZWdyZWVzUGVyU2VnO1xuXG4gICAgICBsZXQgcG9zID0ge1xuICAgICAgICB4OiBjZW50ZXJQb3MueCArIE1hdGguY29zKGQycih0aGV0YSkpICogSEVJR0hUICogUklOR19SQURJVVMgKiAoaSArIDIpLFxuICAgICAgICB5OiBjZW50ZXJQb3MueSArIE1hdGguc2luKGQycih0aGV0YSkpICogSEVJR0hUICogUklOR19SQURJVVMgKiAoaSArIDIpXG4gICAgICB9O1xuXG4gICAgICBsZXQgcGxhY2VkID0gc3ltYm9sc1tpXS5wbGFjZShuZXcgUG9pbnQocG9zLngsIHBvcy55KSk7XG4gICAgICBsZXQgc2l6ZSA9IGNoYW5jZS5mbG9hdGluZyh7IG1pbjogU0hBUEVfU0laRSwgbWF4OiBTSEFQRV9TSVpFICogKGkgKyAxKSB9KTtcbiAgICAgIHBsYWNlZC5zY2FsZShzaXplKTtcblxuICAgICAgcGxhY2VkLmRhdGEuZWxpZ2libGUgPSB0cnVlO1xuICAgICAgcGxhY2VkLmRhdGEuY29sb3JJbmRleCA9IGk7XG4gICAgICBwbGFjZWQuZGF0YS5zaXplID0gc2l6ZTtcblxuICAgICAgc2hhcGVzQXJyLnB1c2gocGxhY2VkKTtcbiAgICAgIHJpbmdHcm91cHNbaV0uYWRkQ2hpbGQocGxhY2VkKTtcbiAgICB9XG5cbiAgfVxuXG5cbn07XG5cbmNvbnN0IHJlcG9zaXRpb25TaGFwZXMgPSAoKSA9PiB7XG5cbiAgY29uc3QgZGVncmVlc1BlclNlZyA9IDM2MCAvIE5VTV9TSEFQRVM7XG4gIGNvbnN0IGNlbnRlclBvcyA9IHBhcGVyLnZpZXcuY2VudGVyO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgTlVNX1JJTkdTOyBpKyspIHtcblxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgTlVNX1NIQVBFUzsgaisrKSB7XG5cbiAgICAgIGxldCB0aGV0YSA9IGogKiBkZWdyZWVzUGVyU2VnO1xuXG4gICAgICBsZXQgcG9zID0ge1xuICAgICAgICB4OiBjZW50ZXJQb3MueCArIE1hdGguY29zKGQycih0aGV0YSkpICogSEVJR0hUICogUklOR19SQURJVVMgKiAoaSArIDIpLFxuICAgICAgICB5OiBjZW50ZXJQb3MueSArIE1hdGguc2luKGQycih0aGV0YSkpICogSEVJR0hUICogUklOR19SQURJVVMgKiAoaSArIDIpXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBpbmR4ID0gKGkgKiBOVU1fU0hBUEVTKSArIGo7XG5cbiAgICAgIGlmIChpbmR4IDwgc2hhcGVzQXJyLmxlbmd0aCkge1xuICAgICAgICBzaGFwZXNBcnJbaW5keF0ucG9zaXRpb24gPSBwb3M7XG5cbiAgICAgIH1cbiAgICB9XG5cbiAgfVxufTtcblxuY29uc3Qgb25SZXNpemUgPSB2aWV3ID0+IHtcbiAgV0lEVEggPSB2aWV3LnNpemUud2lkdGg7XG4gIEhFSUdIVCA9IHZpZXcuc2l6ZS5oZWlnaHQ7XG5cbiAgcmVwb3NpdGlvblNoYXBlcygpO1xufTtcblxuY29uc3QgZDJyID0gZGVnID0+IHtcbiAgcmV0dXJuIGRlZyAqIE1hdGguUEkgLyAxODA7XG59O1xuXG5jb25zdCBwbGF5U291bmQgPSBzb3VuZCA9PiB7XG4gIC8vIHRvZG8gLSBmaW5kIHNvdW5kcyBhbmQgaW1wbGVtZW50IHRoaXNcbn07XG5cbmNvbnN0IG9uQ29sbGlkZSA9IChidWxsZXQsIHRhcmdldCwgYW5nbGUpID0+IHtcbiAgLy8gY29uc29sZS5sb2coJ29uQ29sbGlkZScsIGJ1bGxldCk7XG4gIC8vIHNoYXBlIGhhcyBiZWVuIGNvbGxpZGVkIHdpdGhcbiAgLy8gY3JlYXRlIGEgZmV3IG1vcmUgc2hhcGVzIGF0IGl0cyBwb3NpdGlvblxuICAvLyB0aGVuIHJlbW92ZSBpdFxuICBidWxsZXQucmVtb3ZlKCk7XG5cbiAgcGxheVNvdW5kKCdoaXQnKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHRyYWNlcy5sZW5ndGg7IGkrKykge1xuICAgIHRyYWNlc1tpXS5yZW1vdmUoKTtcbiAgfVxuXG4gIC8vIHJlbW92ZSB0YXJnZXRcbiAgdGFyZ2V0LmRhdGEuZWxpZ2libGUgPSBmYWxzZTtcbiAgdGFyZ2V0Lm9wYWNpdHkgPSAwO1xuXG4gIGNvbnN0IGV4cGxvc2lvblJhZGl1cyA9IGNoYW5jZS5pbnRlZ2VyKHsgbWluOiAxMCwgbWF4OiAzMCB9KTtcbiAgY29uc3QgbnVtUGFydHMgPSAxMjtcbiAgbGV0IGV4cGxvc2lvblNoYXBlID0gY3JlYXRlRXhwbG9zaW9uUGF0aChleHBsb3Npb25SYWRpdXMsIHRhcmdldC5kYXRhLmNvbG9ySW5kZXgpO1xuICBleHBsb3Npb25TaGFwZS5wb3NpdGlvbiA9IHRhcmdldC5wb3NpdGlvbjtcblxuICBjb25zdCBlbGxpcHNpc011bHRpcGxpZXIgPSBjaGFuY2UuZmxvYXRpbmcoeyBtaW46IDAuMiwgbWF4OiAxLjggfSk7XG4gIGV4cGxvc2lvblNoYXBlLnNjYWxlKHsgeDogMSwgeTogZWxsaXBzaXNNdWx0aXBsaWVyIH0pO1xuICBsYXRlc3RFeHBsb3Npb25Hcm91cCA9IG5ldyBHcm91cChbIGV4cGxvc2lvblNoYXBlIF0pO1xuICBsYXRlc3RFeHBsb3Npb25XZWlnaHQgPSBleHBsb3Npb25SYWRpdXMgLyA1MDtcblxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtUGFydHM7IGkrKykge1xuXG4gICAgLy8gY29uc3QgdGhldGEgPSBhbmdsZSArIChpICogKDE4MCAvIG51bVBhcnRzKSkgLSA5MDtcbiAgICBjb25zdCB0aGV0YSA9IGFuZ2xlICsgaSAqICgzNjAgLyBudW1QYXJ0cyk7XG5cbiAgICBsZXQgcG9zID0ge1xuICAgICAgeDogdGFyZ2V0LnBvc2l0aW9uLnggKyAoZXhwbG9zaW9uUmFkaXVzICogTWF0aC5jb3MoZDJyKHRoZXRhKSkpLFxuICAgICAgeTogdGFyZ2V0LnBvc2l0aW9uLnkgKyAoZXhwbG9zaW9uUmFkaXVzICogTWF0aC5zaW4oZDJyKHRoZXRhKSkgKiBlbGxpcHNpc011bHRpcGxpZXIpXG4gICAgfTtcblxuICAgIGxldCBwbGFjZWQgPSBzeW1ib2xzW3RhcmdldC5kYXRhLmNvbG9ySW5kZXhdLnBsYWNlKG5ldyBQb2ludChwb3MueCwgcG9zLnkpKTtcbiAgICAvLyBwbGFjZWQucm90YXRlKGNoYW5jZS5pbnRlZ2VyKHsgbWluOiAwLCBtYXg6IDE4MCB9KSk7XG4gICAgbGV0IHNpemUgPSBjaGFuY2UuZmxvYXRpbmcoeyBtaW46IFBBUlRfU0laRSwgbWF4OiBQQVJUX1NJWkUgKiAodGFyZ2V0LmRhdGEuY29sb3JJbmRleCArIDEpIH0pO1xuICAgIHBsYWNlZC5zY2FsZShzaXplKTtcblxuICAgIHBsYWNlZC5kYXRhLmVsaWdpYmxlID0gZmFsc2U7XG4gICAgcGxhY2VkLmRhdGEuc2l6ZSA9IHNpemU7XG4gICAgcGxhY2VkLmRhdGEuY29sb3JJbmRleCA9IHRhcmdldC5kYXRhLmNvbG9ySW5kZXg7XG4gICAgcGxhY2VkLmRhdGEub3JpZ2luID0gdGFyZ2V0LnBvc2l0aW9uO1xuICAgIHBsYWNlZC5kYXRhLnRoZXRhID0gdGhldGE7XG4gICAgcGxhY2VkLmRhdGEucGFyZW50UG9zaXRpb24gPSB0YXJnZXQucG9zaXRpb247XG5cbiAgICBleHBsb2RpbmdTaGFwZXMucHVzaChwbGFjZWQpO1xuICAgIGluZWxpZ2libGVTaGFwZXMucHVzaChwbGFjZWQpO1xuXG4gICAgc2hhcGVzQXJyLnB1c2gocGxhY2VkKTtcbiAgICBsYXRlc3RFeHBsb3Npb25Hcm91cC5hZGRDaGlsZChwbGFjZWQpO1xuICB9XG5cbiAgYmFja2dyb3VuZEdyb3VwLmFkZENoaWxkKGxhdGVzdEV4cGxvc2lvbkdyb3VwKTtcblxuICBOVU1fU0hBUEVTICs9IG51bVBhcnRzIC0gMTtcbiAgZXhwbG9zaW9uSW5Qcm9ncmVzcyA9IHRydWU7XG5cbiAgZmlyZU5ld1NoYXBlKCk7XG5cbn07XG5cbmNvbnN0IGZpcmVOZXdTaGFwZSA9ICgpID0+IHtcblxuICBwbGF5U291bmQoJ2ZpcmUnKTtcblxuICBjdXJyZW50QnVsbGV0SW5kZXggPSBjaGFuY2UuaW50ZWdlcih7IG1pbjogMCwgbWF4OiBzaGFwZXNBcnIubGVuZ3RoIC0gMSB9KTtcblxuICAvLyBlbnN1cmUgbm8gbmV3bHkgY3JlYXRlZCBwYXJ0aWNsZXMgYXJlIHRoZSBuZXcgdGFyZ2V0XG4gIGN1cnJlbnRUYXJnZXRJbmRleCA9IGNoYW5jZS5pbnRlZ2VyKHsgbWluOiAwLCBtYXg6IHNoYXBlc0Fyci5sZW5ndGggLSAxIH0pO1xuXG4gIGlmIChzaGFwZXNBcnJbY3VycmVudEJ1bGxldEluZGV4XS5kYXRhLmVsaWdpYmxlXG4gICAgJiYgY3VycmVudEJ1bGxldEluZGV4ICE9PSBjdXJyZW50VGFyZ2V0SW5kZXhcbiAgICAmJiB0eXBlb2Ygc2hhcGVzQXJyW2N1cnJlbnRCdWxsZXRJbmRleF0uX2luZGV4ICE9PSAndW5kZWZpbmVkJykge1xuICAgIG1vdmUgPSB0cnVlO1xuICB9IGVsc2Uge1xuICAgIC8vIGNvbnNvbGUud2Fybignbm90IGVsaWdpYmxlJyk7XG4gICAgZmlyZU5ld1NoYXBlKCk7XG4gIH1cblxufTtcblxubGV0IGxhc3RTaGlmdGVkQXQgPSAwO1xubGV0IHNoaWZ0RXZlcnkgPSAyMDA7XG5sZXQgZXhwbG9zaW9uSW5Qcm9ncmVzcyA9IGZhbHNlO1xubGV0IHRyYWNlcyA9IFtdO1xuXG5jb25zdCBvbk1vdXNlRG93biA9IGV2ZW50ID0+IHtcblxuICBpZiAoIWJhY2tncm91bmRHcm91cCkge1xuICAgIGJhY2tncm91bmRHcm91cCA9IG5ldyBHcm91cCgpO1xuICB9XG5cbiAgbGV0IGluZHggPSBjaGFuY2UuaW50ZWdlcih7IG1pbjogMCwgbWF4OiBzeW1ib2xzLmxlbmd0aCAtIDEgfSk7XG5cbiAgbGV0IHBvcyA9IGV2ZW50LnBvaW50O1xuICBsZXQgcGxhY2VkID0gc3ltYm9sc1tpbmR4XS5wbGFjZShuZXcgUG9pbnQocG9zLngsIHBvcy55KSk7XG4gIHBsYWNlZC5kYXRhLmNvbG9ySW5kZXggPSBpbmR4O1xuICAvLyBwbGFjZWQucm90YXRlKGNoYW5jZS5pbnRlZ2VyKHsgbWluOiAwLCBtYXg6IDE4MCB9KSk7XG4gIGxldCBzaXplID0gY2hhbmNlLmZsb2F0aW5nKHsgbWluOiBTSEFQRV9TSVpFLCBtYXg6IFNIQVBFX1NJWkUgKiAoaW5keCArIDEpIH0pO1xuICBwbGFjZWQuc2NhbGUoc2l6ZSk7XG5cbiAgcGxhY2VkLmRhdGEuZWxpZ2libGUgPSB0cnVlO1xuICBwbGFjZWQuZGF0YS5zaXplID0gc2l6ZTtcbiAgc2hhcGVzQXJyLnB1c2gocGxhY2VkKTtcbiAgYmFja2dyb3VuZEdyb3VwLmFkZENoaWxkKHBsYWNlZCk7XG4gIE5VTV9TSEFQRVMrKztcbn07XG5cbmxldCBudW1EcmFnRXZlbnRzID0gMDtcblxuY29uc3Qgb25Nb3VzZURyYWcgPSBldmVudCA9PiB7XG5cbiAgaWYgKG51bURyYWdFdmVudHMgJSAyID09PSAwKSB7XG4gICAgb25Nb3VzZURvd24oZXZlbnQpO1xuXG4gIH1cblxuICBudW1EcmFnRXZlbnRzKys7XG59O1xuXG5jb25zdCBvbkZyYW1lID0gZXZlbnQgPT4ge1xuICAvLyBjb25zb2xlLmxvZyhldmVudCk7XG5cbiAgLy8gcmluZ0dyb3VwLnJvdGF0ZSguMSk7XG4gIC8vIGlubmVyUmluZ0dyb3VwLnJvdGF0ZSgtMC4xKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBOVU1fUklOR1M7IGkrKykge1xuICAgIGxldCBzcGVlZCA9IChOVU1fUklOR1MgLSBpKSAqIDAuMDEgKiBvcmJpdFNwZWVkO1xuICAgIHJpbmdHcm91cHNbaV0ucm90YXRlKHNwZWVkLCBwYXBlci52aWV3LmNlbnRlcik7XG4gIH1cblxuICBpZiAobGF0ZXN0RXhwbG9zaW9uR3JvdXAgJiYgbGF0ZXN0RXhwbG9zaW9uR3JvdXAuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgbGF0ZXN0RXhwbG9zaW9uR3JvdXAucm90YXRlKGxhdGVzdEV4cGxvc2lvbldlaWdodCk7XG4gIH1cblxuICBpZiAoYmFja2dyb3VuZEdyb3VwICYmIGJhY2tncm91bmRHcm91cC5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICBiYWNrZ3JvdW5kR3JvdXAucm90YXRlKDAuMDEgKiBvcmJpdFNwZWVkLCBwYXBlci52aWV3LmNlbnRlcik7XG4gIH1cblxuXG5cbiAgLy8gbW92aW5nIGJ1bGxldFxuICBpZiAobW92ZSkge1xuICAgIGxldCB2ZWN0b3IgPSBzaGFwZXNBcnJbY3VycmVudFRhcmdldEluZGV4XS5wb3NpdGlvbi5zdWJ0cmFjdChzaGFwZXNBcnJbY3VycmVudEJ1bGxldEluZGV4XS5wb3NpdGlvbik7XG4gICAgY29uc3Qgb3JpZ2luYWxMZW5ndGggPSB2ZWN0b3IubGVuZ3RoO1xuXG4gICAgLy8gaWYgKGV2ZW50LmNvdW50ICUgMiA9PT0gMCkge1xuICAgICAgdHJhY2VzLnB1c2godHJhY2UucGxhY2UobmV3IFBvaW50KHNoYXBlc0FycltjdXJyZW50QnVsbGV0SW5kZXhdLnBvc2l0aW9uKSkpO1xuXG4gICAgLy8gfVxuXG4gICAgdmVjdG9yLmxlbmd0aCA9IFdJRFRIIC8gMjtcbiAgICBzaGFwZXNBcnJbY3VycmVudEJ1bGxldEluZGV4XS5wb3NpdGlvbiA9IHNoYXBlc0FycltjdXJyZW50QnVsbGV0SW5kZXhdLnBvc2l0aW9uLmFkZCh2ZWN0b3IuZGl2aWRlKDM2MCAvIGJ1bGxldFNwZWVkKSk7XG4gICAgc2hhcGVzQXJyW2N1cnJlbnRCdWxsZXRJbmRleF0ucm90YXRlKDEpO1xuXG4gICAgaWYgKG9yaWdpbmFsTGVuZ3RoIDwgNSkge1xuXG4gICAgICBtb3ZlID0gZmFsc2U7XG4gICAgICBvbkNvbGxpZGUoc2hhcGVzQXJyW2N1cnJlbnRCdWxsZXRJbmRleF0sIHNoYXBlc0FycltjdXJyZW50VGFyZ2V0SW5kZXhdLCB2ZWN0b3IuYW5nbGUpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChleHBsb3Npb25JblByb2dyZXNzKSB7XG4gICAgLy8gbW92ZSBwYXJ0cyBvdXQgZnJvbSB0aGVpciBvcmlnaW5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV4cGxvZGluZ1NoYXBlcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHZlY3RvciA9IGV4cGxvZGluZ1NoYXBlc1tpXS5kYXRhLnBhcmVudFBvc2l0aW9uLnN1YnRyYWN0KGV4cGxvZGluZ1NoYXBlc1tpXS5wb3NpdGlvbik7XG4gICAgICBpZiAodmVjdG9yLmxlbmd0aCA+IDUwKSB7XG4gICAgICAgIGV4cGxvZGluZ1NoYXBlcyA9IFtdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXhwbG9kaW5nU2hhcGVzW2ldLnBvc2l0aW9uID0gZXhwbG9kaW5nU2hhcGVzW2ldLnBvc2l0aW9uLnN1YnRyYWN0KHZlY3Rvci5kaXZpZGUoMzAwKSk7XG4gICAgICAgIC8vIGV4cGxvZGluZ1NoYXBlc1tpXS5yb3RhdGUoMTApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIGVuYWJsZSBuZXcgc2hhcGVzIGFzIGJ1bGxldHMgYW5kIHRhcmdldHNcbiAgaWYgKChldmVudC5jb3VudCAtIGxhc3RTaGlmdGVkQXQgPiBzaGlmdEV2ZXJ5KSAmJiBpbmVsaWdpYmxlU2hhcGVzLmxlbmd0aCkge1xuICAgIHNoaWZ0RXZlcnkgPSBpbmVsaWdpYmxlU2hhcGVzLmxlbmd0aCA+IDIwMCA/IDEgOiAyMDA7XG4gICAgaW5lbGlnaWJsZVNoYXBlc1swXS5kYXRhLmVsaWdpYmxlID0gdHJ1ZTtcbiAgICBpbmVsaWdpYmxlU2hhcGVzLnNoaWZ0KCk7XG4gICAgbGFzdFNoaWZ0ZWRBdCA9IGV2ZW50LmNvdW50O1xuICB9XG5cbiAgLy8gdHJpYW5nbGUuZGVmaW5pdGlvbi5yb3RhdGUoMC41KTtcbiAgLy8gc3F1YXJlLmRlZmluaXRpb24ucm90YXRlKDAuNCk7XG4gIC8vIGhleGFnb24uZGVmaW5pdGlvbi5yb3RhdGUoMC4yKTtcblxufTtcbiJdfQ==
